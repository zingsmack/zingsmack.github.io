<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3D Photography Showcase</title>
  <style>
    html, body { margin: 0; padding: 0; overflow-x: hidden; }
    #renderCanvas { width: 100vw; height: 100vh; display: block; position: fixed; top: 0; left: 0; }
    .spacer { height: 1000vh; }
  </style>
</head>
<body>
  <canvas id="renderCanvas"></canvas>
  <div class="spacer"></div>

  <!-- BabylonJS & GSAP Libraries -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/ScrollTrigger.min.js"></script>

  <script>
    // Basic Babylon.js setup
    const canvas = document.getElementById('renderCanvas');
    const engine = new BABYLON.Engine(canvas, true);
    const scene = new BABYLON.Scene(engine);
    scene.clearColor = new BABYLON.Color4(0.03, 0.01, 0.08, 1);

    // Camera
    const camera = new BABYLON.FreeCamera('camera', new BABYLON.Vector3(0, 0, 0), scene);
    camera.attachControl(canvas, true);

    // Light
    const light = new BABYLON.HemisphericLight('light', new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.8;

    // Tube geometry (tunnel)
    const frames = [];
    const frameCount = 10;
    const pathLength = 300;
    const tubePath = [];
    for (let i = 0; i <= pathLength; i++) {
      const t = i / pathLength;
      tubePath.push(
        new BABYLON.Vector3(
          Math.sin(t * Math.PI * 2) * 8,
          Math.cos(t * Math.PI * 2) * 4,
          t * 150
        )
      );
    }
    const tube = BABYLON.MeshBuilder.CreateTube('tube', { path: tubePath, radius: 6, sideOrientation: BABYLON.Mesh.DOUBLESIDE }, scene);
    const tubeMat = new BABYLON.StandardMaterial('tubeMat', scene);
    tubeMat.alpha = 0.1;
    tube.material = tubeMat;

    // Create portrait frames
    for (let i = 0; i < frameCount; i++) {
      const node = new BABYLON.TransformNode('frame' + i, scene);
      // border
      const border = BABYLON.MeshBuilder.CreateBox('border' + i, { width: 2, height: 3, depth: 0.1 }, scene);
      border.parent = node;
      border.renderOutline = true;
      border.outlineColor = BABYLON.Color3.White();
      border.outlinesWidth = 0.05;
      // placeholder plane
      const plane = BABYLON.MeshBuilder.CreatePlane('plane' + i, { width: 1.8, height: 2.8 }, scene);
      plane.parent = node;
      plane.position.z = 0.06;

      const dynamicTexture = new BABYLON.DynamicTexture('dt' + i, { width: 512, height: 768 }, scene);
      dynamicTexture.getContext().fillStyle = 'transparent';
      dynamicTexture.drawText('Your Portrait', 50, 380, 'bold 48px Arial', '#fff', 'transparent');
      const mat = new BABYLON.StandardMaterial('mat' + i, scene);
      mat.diffuseTexture = dynamicTexture;
      mat.emissiveColor = new BABYLON.Color3(1, 1, 1);
      plane.material = mat;

      // position along tunnel
      const idx = Math.floor((i + 1) * (pathLength / (frameCount + 1)));
      node.position = tubePath[idx].clone();
      frames.push(node);
    }

    // Scroll-triggered camera movement
    gsap.registerPlugin(ScrollTrigger);
    gsap.to(camera.position, {
      z: tubePath[pathLength].z,
      ease: 'none',
      scrollTrigger: {
        trigger: '.spacer',
        start: 'top top',
        end: 'bottom bottom',
        scrub: true
      }
    });

    // Optional: frames rotate slightly on scroll
    frames.forEach((node, i) => {
      gsap.to(node.rotation, {
        y: Math.PI * 2,
        ease: 'none',
        scrollTrigger: {
          trigger: '.spacer',
          start: 'top top',
          end: 'bottom bottom',
          scrub: true
        }
      });
    });

    // render loop
    engine.runRenderLoop(() => scene.render());
    window.addEventListener('resize', () => engine.resize());
  </script>
</body>
</html>
